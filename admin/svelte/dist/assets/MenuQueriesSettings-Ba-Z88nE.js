import{p as O,z as i,v as X,w as _,B as s,g as a,f as P,n as T,c as C,s as S,q as E,t as I,r as z,k as g,l as H}from"./vendor-DQEwB2VO.js";import{b,a as J,I as M,B as Q,c as U}from"./shared-x0W_-Tcr.js";var A=P('<div class="cache-ttl-input svelte-1ejrma9"><!></div> <div><!></div> <p class="wpea-text-muted wpea-text-sm">Settings are saved automatically.</p>',1),G=P("<!> <!>",1);function ee(x,j){O(j,!0);const{apiUrl:l,nonce:d}=window.abWpBitsData;let o=i("3600"),p=i(!1),n=i(!1),c=i(X([]));_(()=>{q()});async function q(){try{const t=await(await fetch(`${l}/module-settings/menu-queries`,{headers:{"X-WP-Nonce":d}})).json();t.success&&t.settings&&s(o,String(t.settings.cache_ttl||3600),!0)}catch(e){console.error("Failed to load settings:",e)}}async function F(){s(p,!0);try{(await(await fetch(`${l}/module-settings/menu-queries`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":d},body:JSON.stringify({cache_ttl:Number(a(o))})})).json()).success?r("Settings saved successfully","success"):r("Failed to save settings","danger")}catch(e){console.error("Failed to save settings:",e),r("Error saving settings","danger")}finally{s(p,!1)}}async function N(){s(n,!0);try{(await(await fetch(`${l}/module-settings/menu-queries/clear-cache`,{method:"POST",headers:{"X-WP-Nonce":d}})).json()).success?r("Cache cleared successfully","success"):r("Failed to clear cache","danger")}catch(e){console.error("Failed to clear cache:",e),r("Error clearing cache","danger")}finally{s(n,!1)}}function r(e,t="success"){const f=`toast-${Date.now()}`;s(c,[...a(c),{id:f,message:e,variant:t,duration:3e3}],!0)}let u=null;_(()=>{a(o),u&&clearTimeout(u),u=window.setTimeout(()=>{F()},1e3)});var v=G(),m=T(v);b(m,{children:(e,t)=>{J(e,{title:"Cache Settings",children:(f,K)=>{b(f,{children:(W,R)=>{var $=A(),y=T($),k=C(y);M(k,{id:"cache-ttl",label:"Cache TTL (seconds)",type:"number",help:"How long to cache query results. Default is 3600 seconds (1 hour).",get value(){return a(o)},set value(h){s(o,h,!0)}});var D=S(y,2),L=C(D);Q(L,{variant:"secondary",onclick:N,get disabled(){return a(n)},children:(h,V)=>{var w=E();I(()=>z(w,a(n)?"Clearing...":"Clear Cache")),g(h,w)},$$slots:{default:!0}}),g(W,$)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}});var B=S(m,2);U(B,{position:"top-right",get toasts(){return a(c)},set toasts(e){s(c,e,!0)}}),g(x,v),H()}export{ee as default};
